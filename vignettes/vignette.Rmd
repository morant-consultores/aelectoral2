---
title: "vignette"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
# library(aelectoral2)
devtools::load_all()
```

La forma más sencilla de cargar una base de datos electoral es indicando la elección y la entidad

```{r}
bd <- Electoral$new(eleccion = "df_21", entidad = "dgo")
```

Por defecto, bd$bd está agregada por sección y se agregan las columnas de estado (id y nombre), el tipo de elección es mayoría relativa, se mantiene el voto en el extranjero y ninguna acción es realizada con las casillas especiales. Observe la descripción:

```{r}
bd
```

Es posible agregar más elecciones a bd$bd con el siguiente código

```{r}
bd$agregar_bd(eleccion = "df_18", entidad = "dgo")
```

Es posible que se requieran más variables cartográficas como distritos locales, federales o municipios. Para eso existe el comando llaves.

```{r}
bd <- Electoral$new("df_21", entidad = "dgo",
                    llaves = c("distritof", "distritol", "municipio")
)

```

Si queremos eliminar el voto en el extranjero se indica con el parámetro extranjero = F

```{r}
bd <- Electoral$new("df_21", entidad = "dgo",
                    llaves = c("distritof", "distritol", "municipio"), extranjero = F
)
```

Se pueden eliminar las casillas especiales o agregar a las casillas especiales una lista nominal de 750 y hacer un ajuste en todas las demás casillas. Con las opciones eliminar o repartir. Por defecto no hace ninguna acción.

```{r}
bd <- Electoral$new("df_21", entidad = "dgo",
                    llaves = c("distritof", "distritol", "municipio"), extranjero = F, especiales = "eliminar"
)

bd <- Electoral$new("df_21", entidad = "dgo",
                    llaves = c("distritof", "distritol", "municipio"), extranjero = F, especiales = "repartir"
)
```

Adicionalmente se pueden agregar más elecciones a bd. Podemos hacer uso de la función walk para agregar varias eleccciones.

```{r}
c("df_18", "pr_18","gb_16", "pm_16", "pm_19") %>% purrr::walk(~{
  bd$agregar_bd(.x, "dgo")
})
```

